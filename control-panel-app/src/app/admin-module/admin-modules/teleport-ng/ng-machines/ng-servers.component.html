<div class="actions d-flex justify-content-between align-items-center pl-3 pr-3 m-1 mb-2">
    <section class="p-2 mb-3">
        <h5 class="mb-3">{{'TYPE_FILTER' | translate}}</h5>
        <mat-radio-group [formControl]="_typeFilterControl" (change)="typeFilterHandler($event)">
            <mat-radio-button class="mr-3" *ngFor="let type of _filterTypes"
                              [value]="type">{{type.toUpperCase() | translate}}</mat-radio-button>
        </mat-radio-group>
    </section>
    <button mat-flat-button color="accent" (click)="add()" class="align-self-end mb-3">
        <mat-icon>add</mat-icon>
        {{translations.instant('ADD_SERVER_TITLE')}}
    </button>
</div>
<div class="row instances_wrapper">
    <div *ngFor="let item of service.instances$ | async" class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12 instance">
        <control-panel-ui-hardware-item [item]="item" (grant)="grant($event)"
                                        (edit)="edit($event)"
                                        (remove)="remove($event)"
                                        (revoke)="revoke($event)"
                                        (toggle)="toggle($event)"
                                        (getGames)="getServerGames($event)"></control-panel-ui-hardware-item>
    </div>
    <p *ngIf="!(service.instances$ | async)?.length" class="ml-3">{{'LIST_EMPTY' | translate}}</p>
</div>

<control-panel-trigger [callBack]="service.refresh.bind(service)"></control-panel-trigger>

<ng-template #formTemplate>
    <h4 mat-dialog-title>{{(_edit ? 'EDIT_SERVER_TITLE' : 'ADD_SERVER_TITLE') | translate}}</h4>
    <form [formGroup]="form" class="d-flex flex-column">
        <mat-form-field>
            <label>
                <input matInput placeholder="{{'NAME' | translate}}" formControlName="name">
            </label>
        </mat-form-field>
        <mat-form-field>
            <mat-select formControlName="type">
                <mat-option *ngFor="let type of _controllerTypes" [value]="type">{{type.toUpperCase()}}</mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field>
            <label>
                <input matInput placeholder="{{'SERVER_IP_ADDRESS' | translate}}" formControlName="address">
            </label>
            <mat-error
                    *ngIf="form.get('address')?.errors?.required">{{translations.instant('REQUIRED_FIELD', ['ip'])}}</mat-error>
            <mat-error
                    *ngIf="form.get('address')?.errors?.pattern">{{translations.instant('SERVER_IP_INVALID_ERROR')}}</mat-error>
        </mat-form-field>
        <mat-checkbox formControlName="enabled">{{'ENABLE_SERVER' | translate}}</mat-checkbox>
    </form>
    <control-panel-ui-action-toolbar (confirm)="submit()"
                                     (cancel)="_dialog.close()"
                                     [mode]="_edit ? 'edit' : 'add'"></control-panel-ui-action-toolbar>
</ng-template>

<ng-template #games>
    <div mat-dialog-title>{{'ADMIN_MENU_GAMES' | translate}} | {{_games.server}}</div>
    <div mat-dialog-content>
        <control-panel-games-list [games]="_games.games" (toggle)="toggleGame($event)"></control-panel-games-list>
    </div>
    <div mat-dialog-actions class="d-flex justify-content-end">
        <button mat-button color="warn" [mat-dialog-close]>{{'CLOSE' | translate}}</button>
    </div>
</ng-template>
