<div class="light-theme">
    <control-panel-ui-card class="primary">
        <div panelUICardHeaderTitle>{{translations.instant('GAMES_LIST_TITLE')}}</div>
        <div panelUICardContent>
            <div class="toolbar d-flex justify-content-between align-items-center">
                <control-panel-ui-quick-filter (filterChange)="applyFilter($event)"></control-panel-ui-quick-filter>
                <!--                <button mat-flat-button color="primary" *ngIf="selection.hasValue()"-->
                <!--                        (click)="changePriceForSelectedHandler()">{{translations.instant('CHANGE_PRICE_FOR_SELECTED')}}</button>-->
            </div>

            <table mat-table [dataSource]="dataSource" class="games-table">
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> {{translations.instant('AMUSEMENTS_NAME_LABEL')}} </th>
                    <td mat-cell *matCellDef="let price" [class.disabled]="_editRow && _editRow.id !== price.id">
                        <ng-container *ngIf="_editRow?.id !== price.id">
                            <div class="name mt-3" (click)="edit(price)">{{price.name}}</div>
                            <div class="sub_text mb-3">
                                <span>{{translations.instant('ID')}}:</span><span class="info">{{price.id}}</span>
                            </div>
                        </ng-container>
                        <ng-container *ngIf="_editRow?.id === price.id">
                            <mat-form-field>
                                <input type="text" matInput [formControl]="_form.controls?.name">
                                <mat-error *ngIf="_form.controls?.name?.errors?.required">{{'REQUIRED' | translate}}</mat-error>
                            </mat-form-field>
                        </ng-container>
                    </td>
                </ng-container>
                <ng-container matColumnDef="category">
                    <th mat-header-cell *matHeaderCellDef> {{translations.instant('PACKAGE_CATEGORY')}} </th>
                    <td mat-cell *matCellDef="let price" [class.disabled]="_editRow && _editRow.id !== price.id">
<!--                        TODO can change price category? -->
<!--                        <ng-container *ngIf="_editRow?.id !== price.id">-->
                            {{price.category}}
<!--                        </ng-container>-->
<!--                        <ng-container *ngIf="_editRow?.id === price.id">-->
<!--                            -->
<!--                        </ng-container>-->

                    </td>
                </ng-container>
                <ng-container matColumnDef="maxPlayers">
                    <th mat-header-cell *matHeaderCellDef> {{translations.instant('MAX_PLAYERS')}} </th>
                    <td mat-cell *matCellDef="let price" [class.disabled]="_editRow && _editRow.id !== price.id">
                        <ng-container *ngIf="_editRow?.id !== price.id">
                            <div>{{price.maxPlayers}}</div>
                        </ng-container>
                        <ng-container *ngIf="_editRow?.id === price.id">
                            <mat-form-field>
                                <mat-select [formControl]="_form.controls?.maxPlayers">
                                    <mat-option *ngFor="let count of _players" [value]="count">{{count}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-container>
                    </td>
                </ng-container>
                <ng-container matColumnDef="maxDuration">
                    <th mat-header-cell *matHeaderCellDef> {{translations.instant('MAX_DURATION')}} </th>
                    <td mat-cell *matCellDef="let price" [class.disabled]="_editRow && _editRow.id !== price.id">
                        <ng-container *ngIf="_editRow?.id !== price.id">
                            <div>{{price.maxDuration}} <span>{{'MINUTE' | translate}}</span></div>
                        </ng-container>
                        <ng-container *ngIf="_editRow?.id === price.id">
                            <mat-form-field>
                                <mat-select [formControl]="_form.controls?.maxDuration">
                                    <mat-option *ngFor="let duration of _durations" [value]="duration">{{duration}} {{'MINUTE' | translate}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-container>
                    </td>
                </ng-container>
                <ng-container matColumnDef="price">
                    <th mat-header-cell *matHeaderCellDef> {{translations.instant('PRICE')}} </th>
                    <td mat-cell *matCellDef="let price" [class.disabled]="_editRow && _editRow.id !== price.id">
                        <ng-container *ngIf="_editRow?.id !== price.id">
                            <span class="mr-2 label">{{price.price.amount}} {{price.price.currency}}</span>
                        </ng-container>
                        <ng-container *ngIf="_editRow?.id === price.id">
                            <div class="d-flex align-items-center">
                                <mat-form-field class="amount">
                                    <input type="number" matInput
                                           [formControl]="_form.controls?.price?.controls?.amount">
                                    <mat-error *ngIf="_form.controls?.price?.controls?.amount?.errors?.required">{{'REQUIRED' | translate}}</mat-error>
                                </mat-form-field>
                                <span class="semi-bold">{{price.price.currency}}</span>
                            </div>
                        </ng-container>
                    </td>
                </ng-container>
                <ng-container matColumnDef="edit">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let price"
                        [class.disabled]="_editRow && _editRow.id !== price.id">
                        <div class="d-flex align-items-center justify-content-end" *ngIf="_editRow?.id !== price.id">
                            <button mat-icon-button color="accent" (click)="edit(price)"
                                    [disabled]="_editRow && _editRow?.id !== price.id">
                                <mat-icon>edit</mat-icon>
                            </button>
                        </div>
                        <div class="d-flex align-items-center justify-content-end" *ngIf="_editRow?.id === price.id">
                            <button mat-icon-button
                                    (click)="save()"
                                    matTooltip="{{translations.instant('USER_FORM_EDIT_BUTTON_LABEL')}}"
                                    matTooltipPosition="above">
                                <mat-icon color="primary">check</mat-icon>
                            </button>
                            <button mat-icon-button (click)="_editRow = null"
                                    matTooltip="{{translations.instant('DIALOG_CANCEL_BUTTON_LABEL')}}"
                                    matTooltipPosition="above">
                                <mat-icon color="warn">close</mat-icon>
                            </button>
                        </div>

                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;" class=""
                    (click)="selection.toggle(row)">
                </tr>
            </table>
            <div [hidden]="dataSource.data.length < 50">
                <mat-paginator [pageSizeOptions]="[50]" showFirstLastButtons></mat-paginator>
            </div>
        </div>
    </control-panel-ui-card>

</div>

<!--<ng-template #priceDialogTemplate>-->
<!--    <div class="price-dialog_wrapper" mat-dialog-content>-->
<!--        <h3 mat-dialog-title>{{translations.instant('APPLY_PRICE_TITLE')}}</h3>-->
<!--        <p>{{translations.instant('FOR_NEXT_GAMES_LABEL')}}</p>-->
<!--        <div class="games-list mb-2">-->
<!--            <ul *ngIf="selection.selected.length">-->
<!--                <li *ngFor="let game of selection.selected">{{game.name}}</li>-->
<!--            </ul>-->
<!--            <ul *ngIf="!selection.selected.length && _editRow">-->
<!--                <li>{{_editRow.name}}</li>-->
<!--            </ul>-->
<!--        </div>-->
<!--        <mat-error class="mb-2"-->
<!--                   *ngIf="selection.selected.length > 1">{{'GAME_PRICES_WILL_OVERWRITTEN_NOTE' | translate}}</mat-error>-->
<!--        <form [formGroup]="form">-->
<!--            <div formArrayName="prices" cdkDropList (cdkDropListDropped)="dropPrice($event)">-->
<!--                <h5>{{'PRICES' | translate}}</h5>-->
<!--                <ng-container *ngFor="let price of prices.controls; let index = index">-->
<!--                    <div [formGroupName]="index + ''" class="price" cdkDrag>-->
<!--                        <div class="d-flex justify-content-end align-items-center flex-grow-1">-->
<!--                            <mat-icon class="mr-2 drag-icon" cdkDragHandle>drag_indicator</mat-icon>-->
<!--                            <span class="flex-grow-1">{{translations.instant('TRANSACTION_NUMBER')}} {{index + 1}}</span>-->
<!--                            <button type="button" mat-icon-button color="warn"-->
<!--                                    class="mr-n2"-->
<!--                                    (click)="deletePrice(index)">-->
<!--                                <mat-icon>clear</mat-icon>-->
<!--                            </button>-->
<!--                        </div>-->
<!--                        <div class="fields d-flex justify-content-between">-->
<!--                            <mat-form-field class="promo">-->
<!--                                <mat-select formControlName="promo_id"-->
<!--                                            (selectionChange)="updateExcludedPromo()"-->
<!--                                            [placeholder]="translations.instant('PROMO')">-->
<!--                                    <ng-container *ngFor="let promo of promos">-->
<!--                                        <mat-option *ngIf="excludePromo(promo.id, index)"-->
<!--                                                    value="{{promo.id}}">{{promo.display_name || promo.name}}</mat-option>-->
<!--                                    </ng-container>-->
<!--                                </mat-select>-->
<!--                            </mat-form-field>-->
<!--                            <mat-form-field class="amount">-->
<!--                                <input formControlName="amount" amount-format matInput-->
<!--                                       placeholder="{{'TRANSACTION_AMOUNT' | translate}}">-->
<!--                                <mat-error *ngIf="prices.at(index).get('amount').errors?.required">-->
<!--                                    {{'REQUIRED_FIELD' | translate:[translations.instant('TRANSACTION_AMOUNT')]}}-->
<!--                                </mat-error>-->
<!--                            </mat-form-field>-->
<!--                            <mat-form-field class="currency">-->
<!--                                <mat-select formControlName="currency"-->
<!--                                            placeholder="{{'TRANSACTION_CURRENCY' | translate}}">-->
<!--                                    <mat-option *ngFor="let currency of _currencies"-->
<!--                                                [value]="currency">{{currency}}</mat-option>-->
<!--                                </mat-select>-->
<!--                            </mat-form-field>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </ng-container>-->
<!--                <div *ngIf="prices.controls.length !== promos.length" class="d-flex justify-content-end mb-2">-->
<!--                    <button type="button" mat-button color="primary"-->
<!--                            (click)="addPrice()" class="pl-2">-->
<!--                        <mat-icon>add</mat-icon>-->
<!--                        {{translations.instant('TABLE_ADD')}}-->
<!--                    </button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </form>-->
<!--    </div>-->

<!--    <div class="actions d-flex align-items-center justify-content-end">-->
<!--        <button mat-flat-button color="warn" class="ml-2"-->
<!--                (click)="reset()"-->
<!--                mat-dialog-close>{{translations.instant('DIALOG_CANCEL_BUTTON_LABEL')}}</button>-->
<!--        <button mat-flat-button color="accent" class="ml-2"-->
<!--                (click)="applyPrice()">{{translations.instant('DIALOG_CONFIRM_BUTTON_LABEL')}}</button>-->
<!--    </div>-->
<!--</ng-template>-->

